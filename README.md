# pHASE-Stitcher
# Introduction
a python program to stitch the ReadBack phased genotypes to create the extended haplotypes in F1 hybrid individuals.

This program is designed to extend the haplotypes using the phased genotypes (allele) states of paritally phased F1 hybrids. It exclusively uses the `Phased Genotype i.e PG` and `Phase Block Index i.e PI` generated by the program `pHASER` https://github.com/secastel/phaser , https://github.com/secastel/phaser/tree/master/phaser

Assumption: This program underlies the following assumptions
- maternal and paternal populations are diverged enough that allele frequency in maternal vs. paternal population can be used to indentify which haplotype in F1 came from which population.
- The identified haplotypes can then be stitched to create a genomewide haplotypes for the given F1 hybrid.
- phasing in F1 hybrids need not consider the effects from the recombination since recombination happened in the paternal and maternal population.
- phase state in the F1 can be directly identified by taking into the consideration 
    - allele frequecy of the phased allele in the maternal vs. paternal population
    - running a 0 order markov model which directly utilizes the given frequency of allele in each population
    - or by running a 1st order markov model if there are partially (readback phased) population resequence data
    
    
This program is exclusively designed to phase haplotypes in F1 hybrid for now, but can be equally extended to phase F2 hybrids (awaiting updates).

# Note: This is written in python3 and requires the following modules

pandas

io

pyvcf

itertools

collections

functools


#Usage: 

python Stitcher_using_1stOrderMarkov_InteractiveMode.py --vcf1 MY_subSample.vcf --vcf2 SP_subSample.vcf --pop1 My --pop2 Sp --output test --het_vcf F1_subSample.vcf --f1_sample 2ms04h


